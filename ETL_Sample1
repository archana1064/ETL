
ETL Job-: ADWSHPKSeqActiveGuestFileLoad
Source query-:
DB2_GST_RUV
****************
SELECT G.GST_I AS GST_I, G.PRIM_FRST_N AS PRIM_FRST_N, G.PRIM_LAST_N AS PRIM_LAST_N, P.PSTL_C AS PSTL_C, EMAIL.EMAIL_ADDR_I AS EMAIL_ADDR_I
FROM adw.GST_RUV G LEFT OUTER JOIN ADW.GIFP_CURR_SUV P
ON G.GST_I=P.GST_I
LEFT OUTER JOIN
(SELECT S.GST_I AS GST_I, E.EMAIL_ADDR_I AS EMAIL_ADDR_I FROM 
(Select GST_I, MAX (EMAIL_ADDR_SEQ_I) AS EMAIL_ADDR_SEQ_I from adw.GST_EMAIL_ADDR_SUV GROUP BY GST_I) S,
(SELECT EMAIL_ADDR_SEQ_I, EMAIL_ADDR_I FROM ADW.ACTV_EMAIL_RUV) E
WHERE S.EMAIL_ADDR_SEQ_I=E.EMAIL_ADDR_SEQ_I
) EMAIL ON G.GST_I=EMAIL.GST_I
WHERE (G.GST_I IN (SELECT GST_I FROM adw.GIFS_G_OVRLL_CUV WHERE adw.GIFS_G_OVRLL_CUV.MDSE_ADJD_A_3 > 0)
AND G.GST_I NOT IN (SELECT GST_I FROM adw.TGT_EMP_SUV)) WITH UR


 
